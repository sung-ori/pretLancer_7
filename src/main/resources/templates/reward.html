<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
		xmlns:sec="http://www.thymleaf.org/extras/spring-security">
		
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>포인트 충전 페이지 | 신개념 번역 플랫폼 프릿랜서</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
<script src="https://cdn.iamport.kr/v1/iamport.js"></script>

<script th:src="@{/js/snBarLoader.js}"></script>
<style>

	@font-face {
	    font-family: 'LINESeedKR-Bd';
	    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_11-01@1.0/LINESeedKR-Bd.woff2') format('woff2');
	    font-weight: 700;
	    font-style: normal;
	}
		
	@font-face {
    font-family: 'MBC1961GulimM';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2304-01@1.0/MBC1961GulimM.woff2') format('woff2');
    font-weight: normal;
    font-style: normal;
	}

	@font-face {
    font-family: 'Pretendard-Regular';
    src: url('https://cdn.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-Regular.woff') format('woff');
    font-weight: 400;
    font-style: normal;
	}
	
	@font-face {
    font-family: 'Pretendard-Bold';
    src: url('https://cdn.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-Bold.woff') format('woff');
    font-weight: 700;
    font-style: normal;
	}

	@font-face {
    font-family: 'Pretendard-Black';
    src: url('https://cdn.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-Black.woff') format('woff');
    font-weight: 900;
    font-style: normal;
	}
	
	* {
    font-family: 'Pretendard-Regular';
		color : #2C2E33;

	}
	
	h2{
		color : #2C2E33;
	} 
	
	th {
		font-weight : bold;
	}
	
	.info_table {
		width : 250px;
	
		margin-left:auto; 
    	margin-right:auto;
 
    	border-collapse: separate;
    	border-spacing : 20px;
	}
	
	.info_tr {
		height : 40px;
		border-bottom : solid 1px #D8D8D8;
	}

	#title {
    font-family: 'Pretendard-Black';
		font-size : 45px;
		color : #2C2E33;
	} 

	#title2 {
    font-family: 'Pretendard-Black';
		font-size : 40px;
		color : #2C2E33;
	} 

	#title3 {
    font-family: 'Pretendard-Black';
		font-size : 35px;
		color : #2C2E33;
	} 

	#title4 {
    font-family: 'Pretendard-Black';
		font-size : 30px;
		color : #2C2E33;
	} 


	.title_{
    font-family: 'Pretendard-Bold';
		font-size : 20px;
		color : #2C2E33;
	} 

	.content{
    font-family: 'Pretendard-Regular';
		font-size : 15px;
		color : #D8D8D8;
	} 

	.content_{
    font-family: 'Pretendard-Regular';
		font-size : 15px;
		color : #2C2E33;
	} 
	
	.information {
	text-align : center;
	vertical-align : middle;
	background-color : white;
	border : solid 1px #D8D8D8;
	border-radius : 5px;
	width : 400px;
	height : 450px;
	}

	.information_content{
    font-family: 'Pretendard-Regular';
		font-size : 15px;
		color : #D8D8D8;
	} 
	 	
	.input_translated{
		font-size : 18px;
		background-color : #F2F2F2;
		word-break : break-all;
		
	}
	
		/*div {
			background-color: #EFF0F0;
			border-radius : 5px;
	
		}*/
		
		.outer {
			width : 1000px;
			height : 600px;
			border-radius : 5px;
			
		
		}

		.comment_input {
		
			width : 900px;
			height : 100px;
			
			border : solid 2px #EFF0F0;
			border-radius : 5px;
		
		}
		
		.answer_input {
		
			width : 900px;
			height : 300px;
			
			border : solid 2px #EFF0F0;
			border-radius : 5px;
		
		}
		
		.submit_button{
		
			width : 100px;
			height : 35px;
			background-color:#2334DE;
			color : #FFFFFF;
			
			border : 0px;
			border-radius : 5px;
			
		}

		.button{
		
			width : 50px;
			height : 35px;
			background-color:#2334DE;
			color : #FFFFFF;
			
			border : 0px;
			border-radius : 5px;
			
		}

		.card{
		
			width : 150px;
			height : 35px;
			background-color:#2334DE;
			color : #FFFFFF;
			
			border : 0px;
			border-radius : 5px;
			text-align : center;
			vertical-align : middle;
			
		}

		.kakaotalk{
		
			width : 150px;
			height : 35px;
			background-color:#F9E000;
			color : #FFFFFF;
			
			border : 0px;
			border-radius : 5px;
			
			margin-top: 10px;
		}

</style>
<script type="text/javascript">


let name ="";
let mail = "";
let id = $("#userId").val();

$(document).ready(function() {
getUser();
var IMP = window.IMP;
IMP.init('imp31533133'); 
// $(document).on("click","#charge_kakao",requestCP);
$('#charge_kakao').click(requestCP);
$("#charge_kg").click(requestKG);

});// 제이쿼리


function getUser() {
    $.ajax({
        type:"get",
        url: "../member/getUser",
        // data: {"id" : id},
        dataType: "json",
        success: function(data) {
            name = data.membername;
            email = data.membermail;
        },
        error: function(e) {
            alert(JSON.stringify(e));
        }
     });
}

function requestCP() {
let money = $('input[name="item"]:checked').val();
console.log(money);

IMP.request_pay({
    pg : 'kakaopay',
    // pay_method : 'card', //생략 가능
    // merchant_uid: "order_no_0001", // 상점에서 관리하는 주문 번호
    name : 'PretLancer:포인트 충전',
    amount : money,
    buyer_email : mail,
    buyer_name : name,
    // buyer_tel : '010-1234-5678',
    // buyer_addr : '서울특별시 강남구 삼성동',
    // buyer_postcode : '123-456'
}, function (rsp) {
    console.log(rsp);
    if (rsp.success) {
        var msg = '결제가 완료되었습니다.';
        msg += '고유ID : ' + rsp.imp_uid;
        msg += '상점 거래ID : ' + rsp.merchant_uid;
        msg += '결제 금액 : ' + rsp.paid_amount;
        msg += '카드 승인번호 : ' + rsp.apply_num;
        $.ajax({
            type: "GET", 
            url: "../reward/charge", //충전 금액값을 보낼 url 설정
            data: {
                "amount" : money,
                "payment_method" : "kakaopay"
            },
            success: function(data) {
                alert(data);
            },
            error: function(e) {
                alert(JSON.stringify(e));
            }
        });
    } else {
        var msg = '결제에 실패하였습니다.';
        msg += '에러내용 : ' + rsp.error_msg;
    }
    alert(msg);
    //document.location.href=""; //alert창 확인 후 이동할 url 설정
}); //
}


function requestKG() {
let money = $('input[name="item"]:checked').val();

IMP.request_pay(
    {
        pg: "html5_inicis",		//KG이니시스 pg파라미터 값
        // pay_method: "card",		//결제 방법
        // merchant_uid: "1234578",//주문번호
        name : 'PretLancer:포인트 충전',
        amount : money,
        buyer_email : mail,
        buyer_name : name,
			// buyer_tel: "010-4242-4242",
			// buyer_addr: "서울특별시 강남구 신사동",
			// buyer_postcode: "01181"

    },
    function (rsp) {
			//rsp.imp_uid 값으로 결제 단건조회 API를 호출하여 결제결과를 판단합니다.
        if (rsp.success) {
            var msg = '결제가 완료되었습니다.';
            msg += '고유ID : ' + rsp.imp_uid;
            msg += '상점 거래ID : ' + rsp.merchant_uid;
            msg += '결제 금액 : ' + rsp.paid_amount;
            msg += '카드 승인번호 : ' + rsp.apply_num;

            $.ajax({
                type: "GET", 
                url: "../reward/charge", //충전 금액값을 보낼 url 설정
                data: {
                    "amount" : money,
                    "payment_method" : "KG"
                },
                success: function(data) {
                    alert(data);
                },
                error: function(e) {
                    alert(JSON.stringify(e));
                }
            });
        } else {
            alert("결제에 실패하였습니다. 에러 내용: " + rsp.error_msg);
        }
    }
);
}



</script>
 <!-- 부트스트랩 5.3.1 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- upper bar css 쓰면 왼쪽 사이드바가 작아진다. (부과효과인듯) -->
    <link rel="stylesheet" th:href="@{/assets/css/pages/upperBar.css}">
    <!-- 기본 부트스트랩 링크들 -->
    <link rel="stylesheet" th:href="@{/assets/css/main/app.css}">
    <link rel="stylesheet" th:href="@{/assets/css/main/app-dark.css}">
    <link rel="shortcut icon" th:href="@{/assets/images/logo/favicon.svg}" type="image/x-icon">
    <link rel="shortcut icon" th:href="@{/assets/images/logo/favicon.png}" type="image/png">
    
	<link rel="stylesheet" th:href="@{/assets/css/shared/iconly.css}">
	<!-- 준규상 코드 -->
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script th:src="@{/js/snBarLoader.js}"></script>
	<style>
    	.move-right-50 {transform: translateX(300px);}
		.custom-width {width: 1100px;}
		.b {font-weight: bold;}
    </style>

</head>
<body>
	<div id="snBar-placeholder"></div>
	<br><br><br><br>

	 <div id="main">
	            <header class="mb-3">
	                <a href="#" class="burger-btn d-block d-xl-none">
	                    <i class="bi bi-justify fs-3"></i>
	                </a>
	            </header>
	            
	<div class="page-heading">
	    <h1 id = "title2">리워드</h1>
	    <h6 id = "title_">포인트를 충전하거나, 캐시를 출금 신청할 수 있습니다.</h6>
	    <br>
	    <table class = "content" style = "border-collapse: separate; text-align : center;">
	    	<tr>
			    <td><b><a th:href = "@{/reward/main}">포인트 충전하기&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></b></td>		
			    <td><a th:href = "@{/reward/paybackForm}">캐시 출금하기&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></td>		

	    	</tr>
	    </table>
	    <hr>
	</div>
			
    <input type="hidden" th:value="${#authentication.name}" id="userId">

    <!-- <div class="card-body bg-white mt-0 shadow">
        <p style="font-weight: bold">카카오페이 현재 사용가능</p>
        <label class="box-radio-input"><input type="radio" name="cp_item" value="5000"><span>5,000원</span></label>
        <label class="box-radio-input"><input type="radio" name="cp_item" value="10000"><span>10,000원</span></label>
        <label class="box-radio-input"><input type="radio" name="cp_item" value="15000"><span>15,000원</span></label>
        <label class="box-radio-input"><input type="radio" name="cp_item" value="20000"><span>20,000원</span></label>
        <label class="box-radio-input"><input type="radio" name="cp_item" value="25000"><span>25,000원</span></label>
        <label class="box-radio-input"><input type="radio" name="cp_item" value="30000"><span>30,000원</span></label>
        <label class="box-radio-input"><input type="radio" name="cp_item" value="35000"><span>35,000원</span></label>
        <label class="box-radio-input"><input type="radio" name="cp_item" value="40000"><span>40,000원</span></label>
        <label class="box-radio-input"><input type="radio" name="cp_item" value="50000"><span>50,000원</span></label>
        <p  style="color: #ac2925; margin-top: 30px">카카오페이의 최소 충전금액은 5,000원이며 <br/>최대 충전금액은 50,000원 입니다.</p> -->
        <!-- <button type="button" class="btn btn-lg btn-block  btn-custom" id="charge_kakao">충 전 하 기</button> -->
 
		<div>
        <p class = "title_">포인트가 부족하신가요?<p>
        <p class = "content_">포인트로는 닉네임 변경, 번역 요청 등을 할 수 있습니다.</br> 카드 혹은 카카오페이를 이용해 원하는 만큼 충전해서 이용하세요!</p>
        <p  style="color: #ac2925;">충전 가능한 최소 금액은 5,000원이며, 최대 금액은 50,000원 입니다.</p>
		</div>

		<div class = "information">
		<br>
			<div><span class = "title_">현재 내 포인트 : </span><span th:text = "${member.point}">point default</span> 포인트</div>
			<table class = "info_table">
				<tr style = "border-top : 3px solid #d8d8d8; border-bottom : 1px solid #d8d8d8; margin-top: 0;">
					<td class = "title_">충전 금액</td>
				</tr>
				<tr style = "border-bottom : 1px solid #d8d8d8;">
					<td class = "content_"><input type="radio" name="item" value="5000" checked ><span>5,000원</span></td>
				</tr>
				<tr style = "border-bottom : 1px solid #d8d8d8;">
					<td class = "content_"><input type="radio" name="item" value="10000"><span>10,000원</span></td>
				</tr>
				<tr style = "border-bottom : 1px solid #d8d8d8;">
					<td class = "content_"><input type="radio" name="item" value="20000"><span>20,000원</span></td>
				</tr>
				<tr>
					<td class = "content_"><input type="radio" name="item" value="30000"><span>30,000원</span></td>
				</tr>
				<tr style = "border-top : 1px solid #d8d8d8; border-bottom : 3px solid #d8d8d8;">
					<td class = "content_"><input type="radio" name="item" value="50000"><span>50,000원</span></td>
				</tr>
	        </table>
	        <div>
	        <button type="button" class="card" id="charge_kg" style = "width : 150px; height : 35px; background-color:#2334DE; color : #FFFFFF; border : 0px; border-radius : 5px; text-align : center; vertical-align : middle; margin-left: auto; margin-right : auto; margin-top : 10px; margin-bottom : auto;">카드로 결제하기</button>
	        <button type="button" class="kakaotalk" id="charge_kakao">카카오페이로 결제하기</button>
	        </div>
	    </div>
    </div>
     <!-- 부트스트랩  JS -->
    <script th:src="@{/assets/js/bootstrap.js}"></script>
    <script th:src="@{/assets/js/app.js}"></script>
    
<!-- Need: Apexcharts -->
<script th:src="@{/assets/extensions/apexcharts/apexcharts.min.js}"></script>
<script th:src="@{/assets/js/pages/dashboard.js}"></script>
</body>
</html>